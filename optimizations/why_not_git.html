<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Why not extend Git? - Oxen</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../init.html">üêÇ üåæ Oxen.ai</a></li><li class="chapter-item expanded "><a href="../development.html"><strong aria-hidden="true">1.</strong> Development</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../development/installation.html"><strong aria-hidden="true">1.1.</strong> Installation</a></li><li class="chapter-item expanded "><a href="../development/build_and_run.html"><strong aria-hidden="true">1.2.</strong> Build & Run</a></li><li class="chapter-item expanded "><a href="../development/add_command.html"><strong aria-hidden="true">1.3.</strong> Adding a Command</a></li><li class="chapter-item expanded "><a href="../development/testing.html"><strong aria-hidden="true">1.4.</strong> Testing</a></li><li class="chapter-item expanded "><a href="../development/release.html"><strong aria-hidden="true">1.5.</strong> Release</a></li></ol></li><li class="chapter-item expanded "><a href="../domains.html"><strong aria-hidden="true">2.</strong> Domains</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../domains/repositories.html"><strong aria-hidden="true">2.1.</strong> Repositories</a></li><li class="chapter-item expanded "><a href="../domains/commits.html"><strong aria-hidden="true">2.2.</strong> Commits</a></li><li class="chapter-item expanded "><a href="../domains/branches.html"><strong aria-hidden="true">2.3.</strong> Branches</a></li><li class="chapter-item expanded "><a href="../domains/merkle_trees.html"><strong aria-hidden="true">2.4.</strong> Merkle Trees</a></li><li class="chapter-item expanded "><a href="../domains/data_frames.html"><strong aria-hidden="true">2.5.</strong> Data Frames</a></li><li class="chapter-item expanded "><a href="../domains/schemas.html"><strong aria-hidden="true">2.6.</strong> Schemas</a></li><li class="chapter-item expanded "><a href="../domains/diffs.html"><strong aria-hidden="true">2.7.</strong> Diffs</a></li></ol></li><li class="chapter-item expanded "><a href="../commands.html"><strong aria-hidden="true">3.</strong> Commands</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../commands/init.html"><strong aria-hidden="true">3.1.</strong> init</a></li><li class="chapter-item expanded "><a href="../commands/config.html"><strong aria-hidden="true">3.2.</strong> config</a></li><li class="chapter-item expanded "><a href="../commands/add.html"><strong aria-hidden="true">3.3.</strong> add</a></li><li class="chapter-item expanded "><a href="../commands/status.html"><strong aria-hidden="true">3.4.</strong> status</a></li><li class="chapter-item expanded "><a href="../commands/commit.html"><strong aria-hidden="true">3.5.</strong> commit</a></li><li class="chapter-item expanded "><a href="../commands/checkout.html"><strong aria-hidden="true">3.6.</strong> checkout</a></li><li class="chapter-item expanded "><a href="../commands/push.html"><strong aria-hidden="true">3.7.</strong> push</a></li><li class="chapter-item expanded "><a href="../commands/clone.html"><strong aria-hidden="true">3.8.</strong> clone</a></li><li class="chapter-item expanded "><a href="../commands/pull.html"><strong aria-hidden="true">3.9.</strong> pull</a></li></ol></li><li class="chapter-item expanded "><a href="../data_types.html"><strong aria-hidden="true">4.</strong> Data Types</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../data_types/text.html"><strong aria-hidden="true">4.1.</strong> Text</a></li><li class="chapter-item expanded "><a href="../data_types/image.html"><strong aria-hidden="true">4.2.</strong> Image</a></li><li class="chapter-item expanded "><a href="../data_types/audio.html"><strong aria-hidden="true">4.3.</strong> Audio</a></li><li class="chapter-item expanded "><a href="../data_types/video.html"><strong aria-hidden="true">4.4.</strong> Video</a></li><li class="chapter-item expanded "><a href="../data_types/tabular.html"><strong aria-hidden="true">4.5.</strong> Tabular</a></li><li class="chapter-item expanded "><a href="../data_types/binary.html"><strong aria-hidden="true">4.6.</strong> Binary</a></li></ol></li><li class="chapter-item expanded "><a href="../optimizations.html"><strong aria-hidden="true">5.</strong> Optimizations</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../optimizations/merkle_tree.html"><strong aria-hidden="true">5.1.</strong> Merkle Tree</a></li><li class="chapter-item expanded "><a href="../optimizations/concurrency.html"><strong aria-hidden="true">5.2.</strong> Concurrency</a></li><li class="chapter-item expanded "><a href="../optimizations/hashing.html"><strong aria-hidden="true">5.3.</strong> Hashing</a></li><li class="chapter-item expanded "><a href="../optimizations/compression.html"><strong aria-hidden="true">5.4.</strong> Compression</a></li><li class="chapter-item expanded "><a href="../optimizations/networking.html"><strong aria-hidden="true">5.5.</strong> Networking</a></li><li class="chapter-item expanded "><a href="../optimizations/remote_workspace.html"><strong aria-hidden="true">5.6.</strong> Remote Workspace</a></li><li class="chapter-item expanded "><a href="../optimizations/storage.html"><strong aria-hidden="true">5.7.</strong> Storage</a></li><li class="chapter-item expanded "><a href="../optimizations/why_not_git.html" class="active"><strong aria-hidden="true">5.8.</strong> Why not extend Git?</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Oxen</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="why-not-write-an-extension-for-git"><a class="header" href="#why-not-write-an-extension-for-git">Why not write an extension for Git?</a></h1>
<p>We often get asked "Why not use Git-LFS?" and why write an entire Version Control System (VCS) from scratch?</p>
<p>The short answer is developer experience. Owning the tool means owning the end to end developer experience. The plugins and extensions to git that we have tried in the path feel like they were shoe horned in and clunky.</p>
<p>There are certain properties of git that make it great for versioning code, but fall short when it comes to data. Git is really good at huge histories of small text files, like code bases. Where git does not shine is binary files. Many datasets consist of binary files such as images, video, audio, parquet files, etc which are not efficiently stored in git.</p>
<p>There are extensions to git such as git-LFS that work okay when you have one or two large assets that are complimentary to your code, but they are still extremely slow when it comes to versioning large sets of large binary files.</p>
<p>This section dives into some of the reasons why we did not want to use Git-LFS and wrote an entire VCS from scratch.</p>
<h1 id="lfs-is-more-complexity"><a class="header" href="#lfs-is-more-complexity">LFS is More Complexity</a></h1>
<p>The first reason is purely the mental model users have to keep in their head.</p>
<p>To quote <a href="https://gregoryszorc.com/blog/2021/05/12/why-you-shouldn%27t-use-git-lfs/">Gregory Szorc</a>:</p>
<p><em>"LFS is more complex for Git end users.</em></p>
<p><em>Git users have to install, configure, and sometimes know about the existence of Git LFS. Version control should just work. Large file handling should just work. End-users shouldn't have to care that large files are handled slightly differently from small files."</em></p>
<h1 id="network-protocols"><a class="header" href="#network-protocols">Network Protocols</a></h1>
<p>Git sequentially reads and writes objects via <a href="https://dev.to/calebsander/git-internals-part-3-the-ssh-transport-2m5c">packfiles</a> over the network to create your local and remote copies of the repository. This is inefficient for large files, resulting in slow uploads / downloads of data that is not text.</p>
<h1 id="sha-256-is-slow"><a class="header" href="#sha-256-is-slow">SHA-256 is Slow</a></h1>
<p>In order to tell if a file is changed, version control systems use a hashing function of the data. By default git uses SHA-256. This is a relatively slow hashing algorithm. By contrast Oxen uses a faster hashing algorithm called <a href="https://github.com/Cyan4973/xxHash">xxHash</a>. This results in hashing speeds of 31 GB/s for xxHash vs 0.8 GB/s of SHA-256.</p>
<p>The small change in hashing speeds results in an improvement in terms of developer experience when it comes to larger datasets.</p>
<p>If you want to see this in action, simply run <code>git add</code> on a large directory of data vs <code>oxen add</code> and see the difference in time.</p>
<h1 id="git-status-spews-all-files"><a class="header" href="#git-status-spews-all-files">Git Status Spews All Files</a></h1>
<p>Purely from Developer Experience this is not great. What if you add 100k images in a single commit? It's not practical to have git status show you all 100k files that are added.</p>
<p>With datasets we are dealing more with distributions of data, not individual data points.</p>
<h1 id="downloading-full-history"><a class="header" href="#downloading-full-history">Downloading Full History</a></h1>
<p>Git by default downloads the entire history of the repository on clone. When it comes to datasets, I may only want to download the latest version of a file, not the entire history.</p>
<p>Oxen gives you the flexibility to download just what you need at the time of training, inference, or testing.</p>
<h1 id="removing-objects"><a class="header" href="#removing-objects">Removing Objects</a></h1>
<p>Removing objects from git is a bit complex because of the references that are made through out the packfiles. Indices have to be recomputed and the history of the repository has to be rewritten if you want to remove a single file.</p>
<p>https://git-scm.com/book/en/v2/Git-Internals-Maintenance-and-Data-Recovery</p>
<blockquote>
<p>There are a lot of great things about Git, but one feature that can cause issues is the fact that a git clone downloads the entire history of the project, including every version of every file. This is fine if the whole thing is source code, because Git is highly optimized to compress that data efficiently. However, if someone at any point in the history of your project added a single huge file, every clone for all time will be forced to download that large file, even if it was removed from the project in the very next commit. Because it‚Äôs reachable from the history, it will always be there.</p>
</blockquote>
<h1 id="packfiles"><a class="header" href="#packfiles">Packfiles</a></h1>
<p>One of the ways that git can save space is by using delta encoding to store only the differences between files. They do this through the use of <a href="https://dev.to/calebsander/git-internals-part-2-packfiles-1jg8">packfiles</a>. The objects are not stored directly in the objects directory rather packed up together in a packfile to make data transfer and compression easier.</p>
<p>Within a pack file there are multiple ways an object can be stored.</p>
<p>This is great for codebases, but not optimal for binary files.</p>
<h1 id="sources"><a class="header" href="#sources">Sources</a></h1>
<h3 id="git-scm-book"><a class="header" href="#git-scm-book">Git SCM book</a></h3>
<ul>
<li>https://git-scm.com/book/en/v2/Git-Internals-Maintenance-and-Data-Recovery</li>
</ul>
<h3 id="avoid-git-lfs-if-possible"><a class="header" href="#avoid-git-lfs-if-possible">Avoid Git-LFS if Possible</a></h3>
<ul>
<li>https://news.ycombinator.com/item?id=27134972</li>
<li>https://gregoryszorc.com/blog/2021/05/12/why-you-shouldn%27t-use-git-lfs/</li>
</ul>
<h3 id="devto-git-internals"><a class="header" href="#devto-git-internals">Dev.to git-internals</a></h3>
<ul>
<li>https://dev.to/calebsander/git-internals-part-2-packfiles-1jg8</li>
</ul>
<h3 id="pack-files"><a class="header" href="#pack-files">Pack files</a></h3>
<p>Git‚Äôs database internals I: packed object store</p>
<ul>
<li>https://github.blog/2022-08-29-gits-database-internals-i-packed-object-store/#delta-compression</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../optimizations/storage.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../optimizations/storage.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
